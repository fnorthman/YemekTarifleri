Index: app/src/main/java/com/ncorp/yemektarifleri/view/TarifFragment.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.ncorp.yemektarifleri.view\r\n\r\n\r\nimport android.graphics.Bitmap\r\nimport android.graphics.BitmapFactory\r\nimport android.os.Bundle\r\nimport android.view.LayoutInflater\r\nimport android.view.View\r\nimport android.view.ViewGroup\r\nimport androidx.fragment.app.Fragment\r\nimport androidx.navigation.Navigation\r\nimport androidx.room.Room\r\nimport com.ncorp.yemektarifleri.databinding.TarifFragmentBinding\r\nimport com.ncorp.yemektarifleri.managers.PermissionManager\r\nimport com.ncorp.yemektarifleri.managers.PermissionManager.selectedImage\r\nimport com.ncorp.yemektarifleri.model.Tarif\r\nimport com.ncorp.yemektarifleri.roomdb.TarifDB\r\nimport com.ncorp.yemektarifleri.roomdb.TarifDao\r\nimport io.reactivex.rxjava3.android.schedulers.AndroidSchedulers\r\nimport io.reactivex.rxjava3.disposables.CompositeDisposable\r\nimport io.reactivex.rxjava3.schedulers.Schedulers\r\nimport java.io.ByteArrayOutputStream\r\n\r\n\r\nclass TarifFragment : Fragment() {\r\n\tprivate var _binding: TarifFragmentBinding? = null\r\n\tprivate val binding get() = _binding!!\r\n\tprivate lateinit var db: TarifDB\r\n\tprivate lateinit var tarifDao: TarifDao\r\n\tprivate val mDisposable = CompositeDisposable()\r\n\tprivate var secilenTarif: Tarif? = null\r\n\r\n\toverride fun onCreate(savedInstanceState: Bundle?) {\r\n\t\tsuper.onCreate(savedInstanceState)\r\n\r\n\t\t// PermissionManager kaydı yapılır, seçilen bitmap alınır\r\n\t\tPermissionManager.register(this) { bitmap: Bitmap ->\r\n\t\t\tbinding.imageView.setImageBitmap(bitmap)\r\n\t\t}\r\n\t\tdb = Room.databaseBuilder(requireContext(), TarifDB::class.java, \"Tarifler\").build()\r\n\t\ttarifDao = db.tarifDao()\r\n\t}\r\n\r\n\toverride fun onCreateView(\r\n\t\tinflater: LayoutInflater, container: ViewGroup?,\r\n\t\tsavedInstanceState: Bundle?\r\n\t): View {\r\n\t\t_binding = TarifFragmentBinding.inflate(inflater, container, false)\r\n\t\treturn binding.root\r\n\t}\r\n\r\n\toverride fun onViewCreated(view: View, savedInstanceState: Bundle?) {\r\n\t\tsuper.onViewCreated(view, savedInstanceState)\r\n\r\n\t\t// Görsel seçmek için imageView'a tıklanır\r\n\t\tbinding.imageView.setOnClickListener {\r\n\t\t\tPermissionManager.checkGalleryPermission(view)\r\n\t\t}\r\n\r\n\t\tbinding.saveButton.setOnClickListener { save(it) }\r\n\t\tbinding.deleteButton.setOnClickListener { delete(it) }\r\n\r\n\t\targuments?.let {\r\n\t\t\tval bilgi = TarifFragmentArgs.fromBundle(it).bilgi\r\n\t\t\tif (bilgi == \"yeni\") {\r\n\t\t\t\tbinding.saveButton.isEnabled = true\r\n\t\t\t\tbinding.deleteButton.isEnabled = false\r\n\t\t\t\tbinding.nameText.setText(\"\")\r\n\t\t\t\tbinding.invText.setText(\"\")\r\n\t\t\t} else {\r\n\t\t\t\tbinding.saveButton.isEnabled = false\r\n\t\t\t\tbinding.deleteButton.isEnabled = true\r\n\t\t\t\tval id = TarifFragmentArgs.fromBundle(it).id\r\n\r\n\t\t\t\tmDisposable.add(\r\n\t\t\t\t\ttarifDao.findById(id)\r\n\t\t\t\t\t\t.subscribeOn(Schedulers.io())\r\n\t\t\t\t\t\t.observeOn(AndroidSchedulers.mainThread())\r\n\t\t\t\t\t\t.subscribe(this::handleResponseForGet)\r\n\t\t\t\t)\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate fun handleResponseForGet(tarif: Tarif) {\r\n\t\tbinding.nameText.setText(tarif.isim)\r\n\t\tbinding.invText.setText(tarif.malzemeler)\r\n\t\tval bitmap = BitmapFactory.decodeByteArray(tarif.gorsel, 0, tarif.gorsel.size)\r\n\t\tbinding.imageView.setImageBitmap(bitmap)\r\n\t\tsecilenTarif = tarif\r\n\t}\r\n\r\n\tfun save(view: View) {\r\n\t\t// Tarif kaydetme işlemi yapılır\r\n\t\tvar isim = binding.nameText.text.toString()\r\n\t\tval malzemeler = binding.invText.text.toString()\r\n\r\n\t\tif (selectedImage != null) {\r\n\t\t\tval kucukBitmap = kucukBitmapOlustur(selectedImage, 300)\r\n\t\t\tval outputStream = ByteArrayOutputStream()\r\n\t\t\tkucukBitmap.compress(Bitmap.CompressFormat.PNG, 50, outputStream)\r\n\t\t\tval byteArray = outputStream.toByteArray()\r\n\t\t\tval tarif = Tarif(isim, malzemeler, byteArray)\r\n\r\n\r\n\t\t\t//Threading//RxJava\r\n\t\t\tmDisposable.add(\r\n\t\t\t\ttarifDao.ınsert(tarif)\r\n\t\t\t\t\t.subscribeOn(Schedulers.io())\r\n\t\t\t\t\t.observeOn(AndroidSchedulers.mainThread())\r\n\t\t\t\t\t.subscribe(this::handleResponseForInsert)\r\n\t\t\t)\r\n\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tprivate fun handleResponseForInsert() {\r\n\t\t//Önceki fragment'a dön\r\n\t\tval action = TarifFragmentDirections.actionTarifFragmentToListFragment()\r\n\t\tNavigation.findNavController(requireView()).navigate(action)\r\n\r\n\t}\r\n\r\n\tfun delete(view: View) {\r\n\t\t// Tarif silme işlemi yapılır\r\n\t\tif (secilenTarif != null) {\r\n\t\t\tmDisposable.add(\r\n\t\t\t\ttarifDao.delete(secilenTarif!!)\r\n\t\t\t\t\t.subscribeOn(Schedulers.io())\r\n\t\t\t\t\t.observeOn(AndroidSchedulers.mainThread())\r\n\t\t\t\t\t.subscribe(this::handleResponseForInsert)\r\n\t\t\t)\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\toverride fun onDestroy() {\r\n\t\tsuper.onDestroy()\r\n\t\t_binding = null\r\n\t\tmDisposable.clear()\r\n\t}\r\n\r\n}\r\n\r\n\r\nprivate fun kucukBitmapOlustur(kucultulmekIstenenBitmap: Bitmap?, maximumBoyut: Int): Bitmap {\r\n\tvar width = kucultulmekIstenenBitmap!!.width\r\n\tvar height = kucultulmekIstenenBitmap.height\r\n\r\n\tval bitmapOrani: Double = width.toDouble() / height.toDouble()\r\n\r\n\tif (bitmapOrani > 1) {\r\n\t\t//gorsel yatay\r\n\t\twidth = maximumBoyut\r\n\t\tval kisaltilmisYukseklik = width / bitmapOrani\r\n\t\theight = kisaltilmisYukseklik.toInt()\r\n\t} else {\r\n\t\t//gorsel dikey\r\n\t\theight = maximumBoyut\r\n\t\tval kisaltilmisGenislik = height * bitmapOrani\r\n\t\twidth = kisaltilmisGenislik.toInt()\r\n\r\n\t}\r\n\treturn Bitmap.createScaledBitmap(kucultulmekIstenenBitmap!!, width, height, true)\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/ncorp/yemektarifleri/view/TarifFragment.kt b/app/src/main/java/com/ncorp/yemektarifleri/view/TarifFragment.kt
--- a/app/src/main/java/com/ncorp/yemektarifleri/view/TarifFragment.kt	(revision 660fdb08c818de73ef549b59fb2e56b2819b36f7)
+++ b/app/src/main/java/com/ncorp/yemektarifleri/view/TarifFragment.kt	(date 1750637318029)
@@ -105,7 +105,7 @@
 			val tarif = Tarif(isim, malzemeler, byteArray)
 
 
-			//Threading//RxJava
+			//Threading//RxJava//
 			mDisposable.add(
 				tarifDao.ınsert(tarif)
 					.subscribeOn(Schedulers.io())
